---
import '../styles/global.css'

interface Props {
  title: string;
  active: string;
}

const { title, active } = Astro.props;
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <title>{title}</title>
    <style>
      /* Mobile sidebar transitions */
      #sidebar {
        transition: transform 0.3s ease-in-out;
      }
      #sidebar.mobile-hidden {
        transform: translateX(-100%);
      }
      #sidebar-overlay {
        transition: opacity 0.3s ease-in-out;
      }
      #sidebar-overlay.hidden {
        opacity: 0;
        pointer-events: none;
      }
      @media (min-width: 768px) {
        #sidebar {
          transform: translateX(0) !important;
        }
        #sidebar-overlay {
          display: none !important;
        }
      }
    </style>
  </head>
  <body class="bg-slate-900 text-white min-h-screen">
    <div class="flex min-h-screen">
      <!-- Mobile Header -->
      <header class="md:hidden fixed top-0 left-0 right-0 z-40 bg-slate-800 border-b border-slate-700 px-4 py-3 flex items-center justify-between">
        <a href="/" class="flex items-center gap-2">
          <div class="w-8 h-8 bg-emerald-500 rounded-lg flex items-center justify-center text-lg">âˆ</div>
          <span class="font-bold text-white">Loop</span>
        </a>
        <button id="menu-toggle" class="p-2 hover:bg-slate-700 rounded-lg transition-colors" aria-label="Toggle menu">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path id="menu-icon" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
          </svg>
        </button>
      </header>

      <!-- Sidebar Overlay (mobile) -->
      <div id="sidebar-overlay" class="hidden fixed inset-0 bg-black/50 z-40 md:hidden"></div>

      <!-- Sidebar -->
      <aside id="sidebar" class="mobile-hidden md:translate-x-0 w-64 bg-slate-800 border-r border-slate-700 flex flex-col fixed h-full z-50">
        <!-- Logo -->
        <div class="p-4 border-b border-slate-700">
          <a href="/" class="flex items-center gap-3">
            <div class="w-10 h-10 bg-emerald-500 rounded-lg flex items-center justify-center text-xl">âˆ</div>
            <div>
              <div class="font-bold text-white">Loop</div>
              <div class="text-xs text-slate-400">Command Center</div>
            </div>
          </a>
        </div>

        <!-- Navigation -->
        <nav class="flex-1 p-3 space-y-1 overflow-y-auto">
          <a href="/" class={`flex items-center gap-3 px-3 py-2 rounded-lg transition-colors ${active === 'dashboard' ? 'bg-slate-700 text-white' : 'hover:bg-slate-700/50 text-slate-300 hover:text-white'}`}>
            <span>ğŸ </span>
            <span>Dashboard</span>
          </a>
          <a href="/loops" class={`flex items-center gap-3 px-3 py-2 rounded-lg transition-colors ${active === 'loops' ? 'bg-slate-700 text-white' : 'hover:bg-slate-700/50 text-slate-300 hover:text-white'}`}>
            <span>ğŸŒ</span>
            <span>Loops</span>
          </a>
          <a href="/treasury" class={`flex items-center gap-3 px-3 py-2 rounded-lg transition-colors ${active === 'treasury' ? 'bg-slate-700 text-white' : 'hover:bg-slate-700/50 text-slate-300 hover:text-white'}`}>
            <span>ğŸ’°</span>
            <span>Treasury</span>
          </a>
          <a href="/merchants" class={`flex items-center gap-3 px-3 py-2 rounded-lg transition-colors ${active === 'merchants' ? 'bg-slate-700 text-white' : 'hover:bg-slate-700/50 text-slate-300 hover:text-white'}`}>
            <span>ğŸª</span>
            <span>Merchants</span>
          </a>
          <a href="/users" class={`flex items-center gap-3 px-3 py-2 rounded-lg transition-colors ${active === 'users' ? 'bg-slate-700 text-white' : 'hover:bg-slate-700/50 text-slate-300 hover:text-white'}`}>
            <span>ğŸ‘¥</span>
            <span>Users</span>
          </a>
          <a href="/waitlist" class={`flex items-center gap-3 px-3 py-2 rounded-lg transition-colors ${active === 'waitlist' ? 'bg-slate-700 text-white' : 'hover:bg-slate-700/50 text-slate-300 hover:text-white'}`}>
            <span>ğŸ“</span>
            <span>Waitlist</span>
          </a>
          <a href="/support" class={`flex items-center gap-3 px-3 py-2 rounded-lg transition-colors ${active === 'support' ? 'bg-slate-700 text-white' : 'hover:bg-slate-700/50 text-slate-300 hover:text-white'}`}>
            <span>ğŸ§</span>
            <span>Support</span>
          </a>
          
          <div class="pt-4 pb-2">
            <div class="text-xs font-semibold text-slate-500 uppercase tracking-wider px-3">Infrastructure</div>
          </div>
          
          <a href="/solana" class={`flex items-center gap-3 px-3 py-2 rounded-lg transition-colors ${active === 'solana' ? 'bg-slate-700 text-white' : 'hover:bg-slate-700/50 text-slate-300 hover:text-white'}`}>
            <span>â›“ï¸</span>
            <span>Solana</span>
          </a>
          <a href="/oxo" class={`flex items-center gap-3 px-3 py-2 rounded-lg transition-colors ${active === 'oxo' ? 'bg-slate-700 text-white' : 'hover:bg-slate-700/50 text-slate-300 hover:text-white'}`}>
            <span>ğŸª™</span>
            <span>OXO Token</span>
          </a>
          <a href="/analytics" class={`flex items-center gap-3 px-3 py-2 rounded-lg transition-colors ${active === 'analytics' ? 'bg-slate-700 text-white' : 'hover:bg-slate-700/50 text-slate-300 hover:text-white'}`}>
            <span>ğŸ“Š</span>
            <span>Analytics</span>
          </a>
          <a href="/system-health" class={`flex items-center gap-3 px-3 py-2 rounded-lg transition-colors ${active === 'system-health' ? 'bg-slate-700 text-white' : 'hover:bg-slate-700/50 text-slate-300 hover:text-white'}`}>
            <span>ğŸ©º</span>
            <span>System Health</span>
          </a>
          <a href="/settings" class={`flex items-center gap-3 px-3 py-2 rounded-lg transition-colors ${active === 'settings' ? 'bg-slate-700 text-white' : 'hover:bg-slate-700/50 text-slate-300 hover:text-white'}`}>
            <span>âš™ï¸</span>
            <span>Settings</span>
          </a>
        </nav>

        <!-- User -->
        <div class="p-4 border-t border-slate-700">
          <div class="flex items-center gap-3">
            <div class="w-8 h-8 bg-emerald-500/20 rounded-full flex items-center justify-center text-emerald-400">A</div>
            <div class="flex-1 min-w-0">
              <div class="text-sm font-medium text-white truncate">Alex</div>
              <div class="text-xs text-slate-400">Admin</div>
            </div>
          </div>
        </div>
      </aside>

      <!-- Main Content -->
      <main class="flex-1 md:ml-64 pt-14 md:pt-0 overflow-auto min-h-screen">
        <slot />
      </main>
    </div>

    <script>
      const sidebar = document.getElementById('sidebar');
      const overlay = document.getElementById('sidebar-overlay');
      const menuToggle = document.getElementById('menu-toggle');

      function toggleSidebar() {
        sidebar?.classList.toggle('mobile-hidden');
        overlay?.classList.toggle('hidden');
        document.body.classList.toggle('overflow-hidden');
      }

      menuToggle?.addEventListener('click', toggleSidebar);
      overlay?.addEventListener('click', toggleSidebar);

      // Close sidebar when clicking a link (on mobile)
      sidebar?.querySelectorAll('a').forEach(link => {
        link.addEventListener('click', () => {
          if (window.innerWidth < 768) {
            toggleSidebar();
          }
        });
      });
    </script>
  </body>
</html>
